<!DOCTYPE html>
<html lang="fr">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />

	<title>TPI-Eval</title>
	<script>
		const DEBUG = true; // Mode de débogage

		const db_Evals = "DBevals"; // Nom de la base de données (NoSQL, IndexedDB)
		const t_Name = "tpi"; // Nom de l'entité

		const totalEvals = 10; // Nombre total d'évaluations
		let loadedEvaluations = []; // Liste des évaluations chargées via la balise <script> dans le <head> du DOM
		let databaseEvaluations = []; // Liste des évaluations provenant de la base de données

		let tpiEvalCurrent = null; // tpiEval de l'évaluation actuellement chargée
		let counter = 0; // Compteur pour générer un nombre unique
		let currentEvalIndex = 0; // Indice de l'évaluation actuelle

		let isNewEval = false; // Indicateur utilisé pour identifier les évaluations qui n'ont pas d'ID attribué 
		let shouldDisplayPopup = null; // Variable contrôlant l'affichage de la popup

		let isEvalJSDuplicated = false; // Indicateur indiquant si l'évaluation de JavaScript est dupliquée ou non
		let isEvalJSMoreRecent = false; // Indicateur indiquant si l'évaluation de JavaScript est plus récente ou non

		/**
		 * * Charge les scripts JavaScript correspondant aux évaluations.
		 * * @param {number} totalEvals - Le nombre total d'évaluations.
		 * */
		function loadScripts(totalEvals) {
			for (let i = 1; i <= totalEvals; i++) {
				const script = "eval" + i + ".js"; // Nom du fichier script
				const scriptElement = document.createElement("script"); // Création de l'élément <script>
				scriptElement.src = script; // Attribution du chemin du script
				document.head.appendChild(scriptElement); // Ajout de l'élément <script> à la balise <head>
			}
		}

		function reloadPageWithDelay() {
			setTimeout(() => {
				location.reload();
			}, 400);
		}

		function createEvalButton(eval, index) {
			const evalButton = document.createElement("button");
			evalButton.type = "button";

			const evalButtonContent = document.createElement("div");

			evalButton.id = "eval_" + eval.id;
			evalButtonContent.innerHTML = `Éval Num(${index + 1})
			<br> ${eval.dateLastSave instanceof Date ? eval.dateLastSave.toString() : eval.dateLastSave}
			<div class='candidate'>${eval.cartouche.candidate.name}</div>
			<hr>
			<div class='expert1'>Exp1: ${eval.cartouche.expert1.name}</div>
			<div class='expert2'>Exp2: ${eval.cartouche.expert2.name}</div>
			<hr>
			<div class='boss'>Cdp> ${eval.cartouche.boss.name}</div>`;

			const deleteButton = document.createElement("button");
			deleteButton.type = "button";
			deleteButton.classList.add("delete-button");
			// deleteButton.innerHTML="&#10060;"

			evalButton.appendChild(deleteButton);
			evalButton.appendChild(evalButtonContent);

			evalButton.addEventListener("click", () => {
				tpiEvalCurrent = eval;
				load(tpiEvalCurrent);
				showFrom();
			});

			deleteButton.addEventListener("click", (event) => {
				event.stopPropagation();

				// Récupérer la clé de la base de données liée à cette évaluation
				const evalId = event.target.parentNode.id;

				// Extraire l'index à partir de l'ID
				const id = parseInt(evalId.split("_")[1]);

				debugLog(`suppresion en cours id : ${id}`);

				showModal("Êtes-vous sûr de vouloir supprimer cet élément ?", true, id);
			});
			return evalButton;
		}

		function saveEvaluationsToIndexedDB(evals) {
			evals.forEach((eval) => {
				saveToIndexedDB(db_Evals, t_Name, eval);
			});
		}

		function reinitialiserIndexEval() { currentEvalIndex = 0; }

		function loadButtonsEvaluation() {

			const listOfevalsList = document.getElementById("listOfevalsList");

			getFromIndexedDB(db_Evals, t_Name, function (evalDB) {

				debugLog(`evalDB chargée depuis getFromIndexedDB`);

				if (evalDB) {

					evalDB.forEach((eval, index) => {
						const button = createEvalButton(eval, index);
						listOfevalsList.appendChild(button);
					});
					databaseEvaluations = evalDB;
				}
				else {
					msgevalsListelector.style.display = "none";
				}
			});
		}

		function displayEvalControls() {
			const msgevalsListelector = document.getElementById("msgevalsListelector");

			if (loadedEvaluations.length > 0) {
				msgevalsListelector.style.display = "block";
				const content = "Le programme a trouvé les fichiers d'évaluations suivants. \
				<br>Veuillez sélectionner ceux que vous souhaitez importer : ";

				showModal(content);
			}
		}

		// Cette fonction est appelée à l'initialisation de la page
		document.addEventListener("DOMContentLoaded", () => {
			loadScripts(totalEvals);
			loadButtonsEvaluation();

			const shouldDisplayPopup = sessionStorage.getItem('shouldDisplayPopup');

			if (shouldDisplayPopup === null) {

				// Si aucune valeur n'est présente dans le sessionStorage,
				// on l'initialise à 'true' et recharge la page après 3 secondes
				sessionStorage.setItem('shouldDisplayPopup', 'true');
				location.reload(3);
			} else if (shouldDisplayPopup === 'true') {


				// Si la valeur dans le sessionStorage est 'true',
				// on affiche les contrôles d'évaluation après un délai de 200 millisecondes
				setTimeout(displayEvalControls, 200);
				sessionStorage.setItem('shouldDisplayPopup', 'false');
			}
		});
	</script>

	<style>
		:root {
			--primaryColor: #407BB8;
			/* Ancienne: #2c3e50 */
			--secondaryColor: #a5abb0;
			/* Ancienne: #bdc3c7 */
			--successColor: #2f9b5e;
			/* Ancienne: #27ae60 */
			--warningColor: #FAB861;
			/* Ancienne: #f39c12 */
			--dangerColor: #FF706F;
			/* Ancienne: #e74c3c */
			--backgroundColor: #F5F7F8;
			/* Ancienne: #ecf0f1 */
			--modalBackgroundColor: #F5F7F8;
			/* Ancienne: #ecf0f1 */
			--headerBackgroundColor: #84A1B5;
			/* Ancienne: #5D7A94 */
			--textColor: #4D7280;
			/* Ancienne: #2c3e50 */
			--modalTextColor: #4D7280;
			/* Ancienne: #2c3e50 */
			--titleHover: #5CB1E6;
			/* Ancienne: #3498db */
		}

		body {
			font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
			font-size: 16px;
			line-height: 1.4;
			color: var(--textColor);
			padding: 0;
		}

		footer {
			padding-top: 5px;
			position: fixed;
			left: 0;
			bottom: 0;
			background-color: var(--primaryColor);
			width: 100%;
			margin: 0;
		}

		#promptOK {
			display: grid;
			grid-template-rows: auto auto auto;
			margin: auto;
		}

		.confirmButton {
			margin: 0 auto;
			background-color: var(--primaryColor);
			border: none;
			text-align: center;
			font-size: larger;
			font-weight: bolder;
			color: white;
			min-height: 40px;
			min-width: 60%;
		}

		.confirmDelete {
			position: absolute;
			bottom: 0;
			left: 0;
			align-items: center;
			background-color: var(--dangerColor);
			border: none;
			text-align: center;
			font-size: larger;
			font-weight: bolder;
			color: white;
			min-height: 40px;
			width: 100%;
		}
		
		.confirmDelete:hover {
			background-color: var(--secondaryColor);
		}

		.confirmButton:hover {
			background-color: var(--secondaryColor);
		}

		.checkbox-container input[type="checkbox"] {
			position: absolute;
			top: 0;
			left: 0;
			height: 25px;
			width: 25px;
			background-color: var(--modalBackgroundColor);
		}

		.checkbox-container input[type="checkbox"]:hover {
			background-color: var(--modalTextColor);
		}

		.checkbox-container {

			flex-direction: column;
			align-items: center;
			margin-bottom: 15px;
			padding: 10px;
			background-color: var(--backgroundColor);
			border-radius: 4px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		}

		.checkbox-container label {
			display: block;
			margin-left: 5px;
			margin-right: 10px;
			font-weight: bold;
		}

		.loadedEvaluations {
			display: block;
			position: relative;
			padding-left: 35px;
			margin-bottom: 12px;
			cursor: pointer;
			-webkit-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
			user-select: none;
		}

		#title {
			font-size: 3em;
			font-weight: bolder;
			color: var(--primaryColor);
			text-align: center;
			text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
			letter-spacing: 1px;
			padding: 20px;
			font-family: "Times New Roman", Times, serif;
			transition: color 0.3s ease;
			padding-bottom: 2em;
		}

		#title:hover {
			color: var(--titleHover);
		}

		.infoText {
			text-align: center;
			font-size: 18px;
		}

		h1,
		h2,
		h3,
		h4,
		h5,
		h6 {
			line-height: 2;
		}

		a {
			color: #007bff;
			text-decoration: none;
		}

		a:hover {
			text-decoration: underline;
		}

		.row {
			width: 100%;
			display: flex;
			flex-direction: row;
			break-inside: avoid;
		}

		.col-1 {
			width: 8%;
		}

		.col-2 {
			width: 17%;
		}

		.col-6 {
			width: 50%;
		}

		.col-7 {
			width: 56%;
		}

		.col-8 {
			width: 66%;
		}

		.d-none {
			display: none;
		}

		.cell {
			padding: 3px;
			border-bottom: 1px solid black;
			border-right: 1px solid black;
		}

		.header {
			background-color: var(--headerBackgroundColor);
		}

		.table {
			margin: 1px;
			border-top: 1px solid black;
			border-left: 1px solid black;
		}

		.bold {
			font-weight: bolder;
		}

		textarea,
		input[type="text"] {
			border: 1px solid lightgray;
			background-color: #f5f5f5;
			width: 100%;
			padding: 8px;
			font-family: "Calibri", Arial, sans-serif;
			font-size: 14px;
			line-height: 1.6;
			border-radius: 4px;
			box-sizing: border-box;
		}

		textarea {
			resize: vertical;
		}

		.points {
			width: 30px;
			border: none;
			background-color: lightgray;
			text-align: center;
		}

		#divGrade {
			background-color: lightgray;
			font-size: larger;
			border: 1px solid black;
		}

		.value {
			font-weight: bold;
			padding: 4px;
			text-align: left;
		}

		.center {
			text-align: center;
		}

		td {
			width: 60px;
			text-align: center;
		}

		th {
			background-color: var(--headerBackgroundColor);
			color: white;
		}

		tr:nth-child(even) {
			background-color: #f2f2f2;
		}

		#testLoad {
			position: fixed;
			bottom: 55px;
			right: 10px;
			background-color: #f8f9fa;
			color: #6c757d;
			border: none;
			padding: 10px 20px;
			font-size: 14px;
			cursor: pointer;
		}

		#cmdErase {
			position: fixed;
			bottom: 30px;
			right: 10px;
			background-color: var(--modalBackgroundColor);
			color: var(--primaryColor);
			border: none;
			font-size: 25px;
			cursor: pointer;
		}

		#cmdErase:hover,
		#cmdSave:hover,
		#cmdGetFile:hover,
		#cmdFreeze:hover,
		#cmdEmpty:hover {
			background-color: var(--secondaryColor);
		}

		#cmdErase .menu {
			display: none;
			position: relative;
			bottom: 30px;
			/* Ajustement pour placer le menu à gauche */
			background: white;
			padding: 10px;
		}

		#cmdErase:hover .menu {
			display: block;
		}

		.optionMenu:hover {
			background-color: var(--primaryColor);
			color: white;
		}

		#cmdEmpty {
			background-color: var(--primaryColor);
			color: white;
			border: none;
			padding: 10px;
			margin: 10px;
			font-size: 14px;
			cursor: pointer;
			transition: background-color 0.3s ease;
		}

		#listOfevalsList {
			position: static;
			display: flexbox;
			flex-direction: row;
			margin: 2px;
		}

		#listOfevalsList button {
			width: 200px;
			height: 220px;
			margin: 5px;
			border: none;
			background-color: var(--primaryColor);
			color: white;
			text-decoration: none;
			font-size: 14px;
			cursor: pointer;
			position: relative;
			overflow: hidden;
			transition: box-shadow 0.3s ease;
			vertical-align: top;
		}

		#listOfevalsList button .button-content {
			height: 100%;
			display: flex;
			flex-direction: column;
			justify-content: space-between;
		}

		#listOfevalsList button .candidate {
			position: relative;
			margin-bottom: 0;
			padding: 8px 12px;
			background-color: var(--dangerColor);
			width: 100%;
			margin-left: -10px;
		}

		#listOfevalsList button .boss {
			margin-top: 0;
			padding: 8px 12px;
			background-color: var(--successColor);
			width: 100%;
			margin-left: -10px;
		}

		#listOfevalsList button .expert1,
		#listOfevalsList button .expert2 {
			margin-bottom: 3px;
			text-align: left;
		}

		#listOfevalsList button .delete-button {
			position: absolute;
			top: 2px;
			right: 2px;
			width: 20px;
			height: 20px;
			cursor: pointer;
			transition: color 0.3s ease;
		}

		#listOfevalsList button .delete-button::before {
			content: '\2716';
		}

		#listOfevalsList button:hover {
			box-shadow: 0 0 9px rgba(0, 0, 0, 0.9);
			border: 1px solid Gainsboro;
		}

		#listOfevalsList button .delete-button:hover {
			box-shadow: none;
			border: none;
		}

		#listOfevalsList button .delete-button:hover {
			color: var(--dangerColor);
		}

		.button {
			display: inline-block;
			padding: 10px 20px;
			border-radius: 5px;
			background-color: cornflowerblue;
			color: white;
			text-align: center;
			text-decoration: none;
			transition: background-color 0.3s ease;
			margin-right: 10px;
			margin-bottom: 30px;
		}

		.button:hover {
			background-color: dodgerblue;
			color: #333;
		}

		@media print {

			/* Ajoute une marge sur les pages imprimées pour faciliter la lecture */
			@page {
				margin: 1cm;
			}

			body {
				/* Assure une taille de police adéquate pour l'impression */
				font-size: 12pt;
			}

			.pagebreak {
				page-break-before: always;
			}

			.noprint {
				display: none;
			}

			div {
				-webkit-print-color-adjust: exact !important;
				print-color-adjust: exact !important;
			}

			/* Imprime les liens avec leur URL */
			a:after {
				content: " (" attr(href) ") ";
				font-size: 0.8em;
				font-weight: normal;
			}

			/* Retire les éléments visuels qui ne sont pas nécessaires à l'impression */
			.modal,
			#testLoad,
			#cmdErase {
				display: none;
			}

			/* Assure une bonne visibilité des textes */
			:root {
				--textColor: black;
				--primaryColor: black;
				--secondaryColor: black;
				--successColor: black;
				--warningColor: black;
				--dangerColor: black;
			}

			textarea {
				border: 1px solid lightgray;
				background-color: #f5f5f5;
				padding: 8px;
				font-family: "Calibri", Arial, sans-serif;
				font-size: 14px;
				line-height: 1.6;
				border-radius: 4px;
				box-sizing: border-box;
				resize: none;
				/* Pour désactiver le redimensionnement lors de l'impression */
			}
		}

		.modal {
			display: none;
			position: fixed;
			z-index: 1;
			padding-top: 7vh;
			left: 0;
			top: 0;
			width: 100%;
			height: 100%;
			overflow: auto;
			background-color: rgba(0, 0, 0, 0.4);
		}

		.modal-content {
			position: relative;
			min-height: 160px;
			min-width: 400px;
			background-color: var(--modalBackgroundColor);
			margin: auto;
			padding: 12px;
			border: 1px solid var(--backgroundColor);
			width: 75%;
		}

		.close {
			position: absolute;
			top: 5px;
			right: 10px;
			color: var(--modalTextColor);
			font-size: x-large;
			font-weight: bolder;
			cursor: pointer;
		}

		.close:hover,
		.close:focus {
			color: #000;
			text-decoration: none;
		}
	</style>

</head>

<header>
	<!-- The Modal popup, adapted from w3schools -->
	<div id="popup" class="modal">
		<!-- Modal content -->
		<div class="modal-content">
			<div class="close">&times;</div>
			<div id="divModalContent"></div>
		</div>
	</div>
</header>

<body>
	<div id="divSelector">
		<!-- Home page  -->
		<div id="title">TPI-Eval</div>

		<div id="dpdevalsListelector">
			<!-- Ces lignes ne doivent apparaître que si l'utilisateur a le choix -->
			<!-- En effet, si l'utilisateur n'a jamais fait d'évaluation, alors il doit en créer une ! -->

			<p class="infoText">Veuillez choisir une action ci-dessous :</p>
			<button id="cmdEmpty" type="button"> Nouvelle <span class="button-text">Évaluation</span></button>

			<p id="msgevalsListelector">Reprendre une évaluation existante...</p>
			<div id="listOfevalsList"></div>
		</div>

		<button id="cmdErase" type="button">&#9881;
			<div class="menu">
				<div class="optionMenu" id="importEvalsListToDB">
					Importer ses évaluations
				</div>
				<div class="optionMenu" id="exportEvalsListToJSON">
					Exporter ses évaluations
				</div>
				<div class="optionMenu" id="eraseEvalsListToDB">
					Supprimer ses évaluations
				</div>

				<div class="optionMenu" id="printEvalsListDB" style="display: none;">
					Consulter le contenu de la bd
				</div>

			</div>
		</button>
		<input type="file" id="fileInput" accept=".json" style="display: none;">
	</div>

	<div id="divPage" class="d-none">
		<!-- From page -->
		<div id="divSheet">
			<!-- ======================================================================================== -->
			<div id="divHeader">
				<p>
					Procédure de qualification : 88600/1/2/3 Informaticienne
					CFC/Informaticien CFC (Ordonnance 2014)
				</p>
				<p>Formulaire d’évaluation Candidat/-e:<span class="value" id="spnCandidate"></span></p>
				<hr />
			</div>
			<!-- ======================================================================================== -->
			<div id="divCartouche">
				<div class="table">
					<div class="row">
						<div class="cell col-6 bold">
							Entreprise formatrice/Chef·fe de Projet:
							<div><input tabindex="1" id="txtBoss" type="text" /></div>
						</div>
						<div class="cell col-6 bold">
							Candidat·e:
							<div><input tabindex="4" id="txtCandidate" type="text" /></div>
						</div>
					</div>
					<div class="row">
						<div class="cell col-6">
							Téléphone:
							<div><input tabindex="2" id="txtBossPhone" type="text" /></div>
						</div>
						<div class="cell col-6">
							Téléphone:
							<div>
								<input tabindex="5" id="txtCandidatePhone" type="text" />
							</div>
						</div>
					</div>
					<div class="row">
						<div class="cell col-6">
							Email:
							<div><input tabindex="3" id="txtBossMail" type="text" /></div>
						</div>
						<div class="cell col-6">
							Email:
							<div>
								<input tabindex="6" id="txtCandidateMail" type="text" />
							</div>
						</div>
					</div>
				</div>
				<br />
				<div class="table">
					<div class="row">
						<div class="cell col-6 bold">
							Expert·e 1
							<div><input tabindex="7" id="txtExpert1" type="text" /></div>
						</div>
						<div class="cell col-6 bold">
							Expert·e 2
							<div><input tabindex="10" id="txtExpert2" type="text" /></div>
						</div>
					</div>
					<div class="row">
						<div class="cell col-6">
							Téléphone:
							<div>
								<input tabindex="8" id="txtExpert1Phone" type="text" />
							</div>
						</div>
						<div class="cell col-6">
							Téléphone:
							<div>
								<input tabindex="11" id="txtExpert2Phone" type="text" />
							</div>
						</div>
					</div>
					<div class="row">
						<div class="cell col-6">
							Email:
							<div>
								<input tabindex="9" id="txtExpert1Mail" type="text" />
							</div>
						</div>
						<div class="cell col-6">
							Email:
							<div>
								<input tabindex="12" id="txtExpert2Mail" type="text" />
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="text">
				<p>
					Ce document ne doit en aucun cas être montré au candidat après
					l’attribution des points.
				</p>
				<p class="bold">
					Conseils pour l’évaluation et l’attribution de la note
				</p>
				<p class="bold">Documentation</p>
				<p>
					Les experts/expertes traitent tous les documents de manière
					confidentielle. La conservation des dossiers est régie par le droit
					cantonal.
				</p>
				<p class="bold">Evaluation</p>
				<p>
					Le/la chef/-e de projet du TPI et les experts/expertes évaluent les
					compétences professionnelles élargies, le résultat et les
					compétences professionnelles.
				</p>
				<p>L’évaluation du TPI est répartie comme suit :</p>
				<p>
					<span class="bold">Partie A:</span> Compétences professionnelles (20
					critères)
				</p>
				<ul>
					<li>6 critères relatifs à l’analyse et au concept</li>
					<li>
						7 critères relatifs à la réalisation, aux tests et au résultats du
						TPI
					</li>
					<li>
						7 critères spécifiques à la tâche demandée par le supérieur
						professionnel
					</li>
				</ul>
				<p>
					<span class="bold">Partie B:</span> Documentation / rapport du TPI
					(10 critères)
				</p>
				<p>
					<span class="bold">Partie C:</span> Entretien professionnel et
					présentation (10 critères)
				</p>
			</div>
			<!-- ======================================================================================== -->

			<h2 class="pagebreak">Partie A: Compétences professionnelles</h2>
			<div id="tblProComp" class="table" data-part="A">
				<div class="row">
					<div class="cell header col-1"></div>
					<div class="cell header col-7">Question</div>
					<div class="cell header col-1">Pt</div>
					<div class="cell header col-7">Justification</div>
				</div>
			</div>
			<!-- ======================================================================================== -->

			<h2 class="pagebreak">Partie B: Documentation / rapport du TPI</h2>
			<div id="tblDoc" class="table" data-part="B">
				<div class="row">
					<div class="cell header col-1"></div>
					<div class="cell header col-7">Question</div>
					<div class="cell header col-1">Pt</div>
					<div class="cell header col-7">Justification</div>
				</div>
			</div>
			<!-- ======================================================================================== -->

			<h2 class="pagebreak">
				Partie C: Entretien professionnel et présentation
			</h2>
			<div id="tblPres" class="table" data-part="C">
				<div class="row">
					<div class="cell header col-1"></div>
					<div class="cell header col-7">Question</div>
					<div class="cell header col-1">Pt</div>
					<div class="cell header col-7">Justification</div>
				</div>
			</div>
			<!-- ======================================================================================== -->

			<h2 class="pagebreak">Contraction</h2>
			<div class="table">
				<div class="row">
					<div class="cell col-8 bold">Sommes des différentes parties</div>
					<div class="cell col-2 bold">Nombre de points max</div>
					<div class="cell col-2 bold">Points obtenus</div>
				</div>
				<div class="row">
					<div class="cell col-8">Partie A: Compétences professionnelles</div>
					<div class="cell col-2 center">60</div>
					<div id="divTotalA" class="cell col-2 center"></div>
				</div>
				<div class="row">
					<div class="cell col-8">
						Partie B: Documentation / rapport du TPI
					</div>
					<div class="cell col-2 center">30</div>
					<div id="divTotalB" class="cell col-2 center"></div>
				</div>
				<div class="row">
					<div class="cell col-8">
						Partie C: Entretien professionnel et présentation
					</div>
					<div class="cell col-2 center">30</div>
					<div id="divTotalC" class="cell col-2 center"></div>
				</div>
				<div class="row bold">
					<div class="cell col-8">Somme de A + B + C</div>
					<div class="cell col-2 center">120</div>
					<div id="divTotal" class="cell col-2 center"></div>
				</div>
				<div class="row bold">
					<div class="cell col-8">Note (5 * somme / 120) + 1</div>
					<div id="divGrade" class="cell col-2 center"></div>
					<div class="cell col-2 center"></div>
				</div>
			</div>
			<!-- ======================================================================================== -->
			<br />
			<div class="center">
				<table id="tblGrades" style="border-collapse: collapse">
					<tr>
						<th>Points</th>
						<th>Note</th>
						<th>Points</th>
						<th>Note</th>
						<th>Points</th>
						<th>Note</th>
						<th>Points</th>
						<th>Note</th>
						<th>Points</th>
						<th>Note</th>
					</tr>
					<tr>
						<td>0-1</td>
						<td>1,0</td>
						<td>23-25</td>
						<td>2,0</td>
						<td>47-49</td>
						<td>3,0</td>
						<td>71-73</td>
						<td>4,0</td>
						<td>95-97</td>
						<td>5,0</td>
					</tr>
					<tr>
						<td>2-3</td>
						<td>1,1</td>
						<td>26-27</td>
						<td>2,1</td>
						<td>50-51</td>
						<td>3,1</td>
						<td>74-75</td>
						<td>4,1</td>
						<td>98-99</td>
						<td>5,1</td>
					</tr>
					<tr>
						<td>4-5</td>
						<td>1,2</td>
						<td>28-29</td>
						<td>2,2</td>
						<td>52-53</td>
						<td>3,2</td>
						<td>76-77</td>
						<td>4,2</td>
						<td>100-101</td>
						<td>5,2</td>
					</tr>
					<tr>
						<td>6-8</td>
						<td>1,3</td>
						<td>30-32</td>
						<td>2,3</td>
						<td>54-56</td>
						<td>3,3</td>
						<td>78-80</td>
						<td>4,3</td>
						<td>102-104</td>
						<td>5,3</td>
					</tr>
					<tr>
						<td>9-10</td>
						<td>1,4</td>
						<td>33-34</td>
						<td>2,4</td>
						<td>57-58</td>
						<td>3,4</td>
						<td>81-82</td>
						<td>4,4</td>
						<td>105-106</td>
						<td>5,4</td>
					</tr>
					<tr>
						<td>11-13</td>
						<td>1,5</td>
						<td>35-37</td>
						<td>2,5</td>
						<td>59-61</td>
						<td>3,5</td>
						<td>83-85</td>
						<td>4,5</td>
						<td>107-109</td>
						<td>5,5</td>
					</tr>
					<tr>
						<td>14-15</td>
						<td>1,6</td>
						<td>38-39</td>
						<td>2,6</td>
						<td>62-63</td>
						<td>3,6</td>
						<td>86-87</td>
						<td>4,6</td>
						<td>110-111</td>
						<td>5,6</td>
					</tr>
					<tr>
						<td>16-17</td>
						<td>1,7</td>
						<td>40-41</td>
						<td>2,7</td>
						<td>64-65</td>
						<td>3,7</td>
						<td>88-89</td>
						<td>4,7</td>
						<td>112-113</td>
						<td>5,7</td>
					</tr>
					<tr>
						<td>18-20</td>
						<td>1,8</td>
						<td>42-44</td>
						<td>2,8</td>
						<td>66-68</td>
						<td>3,8</td>
						<td>90-92</td>
						<td>4,8</td>
						<td>114-116</td>
						<td>5,8</td>
					</tr>
					<tr>
						<td>21-22</td>
						<td>1,9</td>
						<td>45-46</td>
						<td>2,9</td>
						<td>69-70</td>
						<td>3,9</td>
						<td>93-94</td>
						<td>4,9</td>
						<td>117-118</td>
						<td>5,9</td>
					</tr>
					<tr>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td></td>
						<td>119-120</td>
						<td>6,0</td>
					</tr>
				</table>
			</div>
			<!-- ======================================================================================== -->
			<h2>Remarques</h2>
			<div><textarea tabindex="998" id="txtRemarks"></textarea></div>
			<div style="display: flex; flex-direction: column; margin: 25px">
				<div class="bold" style="display: flex; justify-content: space-around">
					<div style="font-style: italic">Signatures</div>
					<div>
						Chef·fe de projet<br />
						<span style="font-size: small;font-style: italic;font-weight: normal;">(lieu et date)</span>
					</div>
					<div>
						Expert·e 1<br />
						<span style="
                  font-size: small;
                  font-style: italic;
                  font-weight: normal;
                ">(lieu et date)</span>
					</div>
					<div>
						Expert·e 2<br />
						<span style="
                  font-size: small;
                  font-style: italic;
                  font-weight: normal;
                ">(lieu et date)</span>
					</div>
				</div>
				<div style="display: flex; justify-content: space-around">
					<div style="height: 80px; width: 20%"></div>
					<div style="border-bottom: 2px solid black; height: 80px; width: 20%"></div>
					<div style="border-bottom: 2px solid black; height: 80px; width: 20%"></div>
					<div style="border-bottom: 2px solid black; height: 80px; width: 20%"></div>
				</div>
			</div>
		</div>

		<div class="row">

			<div id="cmdFreeze" class="button noprint">Finaliser</div>
			<div id="cmdSave" class="button noprint">Enregistrer</div>
			<div id="cmdGetFile" class="button noprint">Télécharger</div>

		</div>
	</div>

	<footer>
		<div style="color:white">© 2023 TPI-eval. Tous droits réservés. ETML</div>
	</footer>
</body>

<script>
	document.getElementById("printEvalsListDB").addEventListener("click", function () {
		getFromIndexedDB(db_Evals, t_Name, function (evalDB) {
			debugLog(`evalDB chargée depuis getFromIndexedDB`);
		});
	});

	// Utilisation de la fonction pour réinitialiser la base de données
	document.getElementById("eraseEvalsListToDB").addEventListener("click", function () { resetIndexedDB(db_Evals); })

	// tableau associatif
	var criteria = [
		{
			id: "A1",
			title: "Gestion de projet et planification ",
			help: "Les mandats complexes sont résolus à l’aide d’une méthode de gestion de projets. Pour les travaux pratiques également, il convient d’analyser les relations, de planifier le système cible, de comparer les variantes et d’élaborer un plan d’action.<br><h3>Niveau de qualité 3</h3>1. La méthode de gestion de projet choisie est citée dans le rapport. La méthode est appropriée au mandat.<br>2. La méthode de gestion de projet a été correctement mise en œuvre en pratique durant le TPI.<br>3. L’utilisation correcte de la méthode de projet est visible dans la documentation.<br>4. Le mandat du cahier des charges a été analysé de manière approfondie et affiné. Les 4 points sont remplis entièrement<br><h3>Niveau de qualité 2</h3>Trois des points mentionnés sont accomplis<br><h3>Niveau de qualité 1</h3>Deux des points mentionnés sont accomplis<br><h3>Niveau de qualité 0</h3> Uniquement un ou aucun des points mentionnés ne sont accomplis. ",
		},
		{
			id: "A2",
			title: "Acquisition du savoir ",
			help: "Les informations à disposition sont aussi multiples que variées. Le ou la candidat-e peut sélectionner les supports et les canaux d’informations en fonction de la tâche à exécuter, évaluer les informations et les exploiter conformément au but recherché.<br><h3>Niveau de qualité 3</h3>1. Le journal de travail, le rapport de projet ou le protocole des discussions avec le supérieur professionnel démontrent clairement l’acquisition de connaissances<br>2. Sélectionne les sources d'informations alignées aux besoins de ses tâches.<br>3. Choisit judicieusement les sources d'informations et les utilise (transfert du savoir).<br>4. Les sources sont clairement référencées et les parties prenantes au projet peuvent facilement reconstruire le processus d’acquisition de connaissances.<br><h3>Niveau de qualité 2</h3>Trois des critères d'évaluation précités sont remplis.<br><h3>Niveau de qualité 1</h3>Deux des critères d'évaluation précités sont remplis.<br><h3>Niveau de qualité 0</h3> Moins de deux des critères d'évaluation sont remplis. ",
		},
		{
			id: "A3",
			title: "Calendrier / planification ",
			help: "Afin de pouvoir contrôler l’avancement du travail et d’identifier suffisamment tôt des écarts par rapport au calendrier fixé, une comparaison régulière est effectuée entre la situation actuelle et la situation escomptée.Niveau de qualité 3<br>1. Un axe temporel absolu a été défini (Date)<br>2. L'axe temporel est structuré de manière raisonnable (Blocs de 2 ou 4 heures)<br>3. Des activités appropriées ont été formées. Elles couvrent l'entier du travail à réaliser.<br>4. L’ordre de déroulement des tâches est judicieux.<br>5. La répartition du temps des activités est planifiée de manière réaliste.<br>6. La comparaison entre la planification initiale et l’état actuel est transparente et correcte. Les 6 points sont remplis et correctement décrits<br><h3>Niveau de qualité 2</h3>Quatre ou cinq des points mentionnés sont remplis<br><h3>Niveau de qualité 1</h3>Deux ou trois des points mentionnés sont remplis<br><h3>Niveau de qualité 0</h3> Un seul ou aucun des points mentionnés n’est rempli.",
		},
		{
			id: "A4",
			title: "Compréhension conceptuelle ",
			help: "L’énoncé de la tâche, son contexte et le développement de solutions peuvent être présentés de façon simplifiée à l’aide de concepts ou de modèles. A cet égard, les détails sont sciemment laissés de côté et seul l’essentiel est montré (p. ex. points clés, lignes directrices, obstacles).<br><h3>Niveau de qualité 3</h3>1. Définit des concepts ou des modèles structurants<br>2. Les principaux aspects structurants du mandat sont mis en évidence.<br>3. Démontre (dans le rapport du TPI, lors de la présentation ou dans le cadre d’une discussion technique)<br>4. Connait bien les interactions entre les parties/sous-systèmes du travail a réaliser.<br><h3>Niveau de qualité 2</h3>Les deux premiers points ainsi que les points trois ou quatre sont remplis.<br><h3>Niveau de qualité 1</h3>Les deux premiers points sont remplis<br><h3>Niveau de qualité 0</h3> Le point 1 n’est pas rempli ",
		},
		{
			id: "A5",
			title:
				"Environnement de projet : limites du système / interfaces avec le monde extérieur ",
			help: "L’intégration du mandat dans son environnement est documentée.<br><h3>Niveau de qualité 3</h3>Le candidat connait les limites de l'environnement de son projet et peut les décrire. Il connait en détail les différentes interfaces et les a documentées.<br><h3>Niveau de qualité 2</h3>Le candidat connaît les interfaces mais ne sait que partiellement ce qu'elles engendrent ou elles ne sont que partiellement documentées.<br><h3>Niveau de qualité 1</h3>Le candidat se représente vaguement l'environnement et ne connaît pas les interfaces ou ne les a quasiment pas documentées.<br><h3>Niveau de qualité 0</h3> Le candidat ne porte attention qu'à son projet et ne s'inquiète/ne sait pas ce qui se passe dans l'environnement proche du projet ou n’a rien documenté. ",
		},
		{
			id: "A6",
			title: "Test de la solution (planification et exécution) ",
			help: "Chaque solution doit être testée avant sa remise. Un concept de tests est élaboré à cet effet. Il décrit ce qui va être testé et comment.<br><h3>Niveau de qualité 3</h3>1. Le concept de test contient le périmètre (environnement)<br>2. ... un scenario de test (script) comprenant des cas de tests pertinents<br>3. ... les moyens et les méthodes de tests utilisées<br>4. ... les résultats attendus<br>5. Les tests décrits ci-dessus ont tous été effectués<br><h3>Niveau de qualité 2</h3>Quatre des aspects cités sont bien remplis.<br><h3>Niveau de qualité 1</h3>Trois des aspects sont bien remplis ou la solution a été vérifiée sans concept de tests.<br><h3>Niveau de qualité 0</h3> Moins de trois aspects sont bien remplis. ",
		},
		{
			id: "A7",
			title:
				"Volonté de performance / engagement / attitude au travail / mise en œuvre ",
			help: "Le ou la candidat-e fait montre de sa volonté de performance non seulement par sa persévérance et sa flexibilité, mais aussi en traitant de façon adéquate les résultats de son travail dans le cadre du mandat confié. Les connaissances acquises à l’école et en entreprise sont utilisées dans différentes situations et permettent d’entreprendre des actions selon les objectifs visés.<br><h3>Niveau de qualité 3</h3>L’élaboration des résultats du travail montre que le candidat réfléchit au- delà de la donnée du problème et complète les éléments manquants ce qui montre qu’il comprend la tâche dans son ensemble. Le candidat utilise son temps et ses compétences pour obtenir des résultats optimaux dans son travail. Il connaît les bases théoriques des techniques utilisées et a pu les utiliser de la meilleure manière dans le cadre du TPI. Son approche des problématiques démontre une démarche ciblée de l’objectif à atteindre.<br><h3>Niveau de qualité 2</h3>L’élaboration des résultats du travail montre que le candidat réfléchit au- delà de la donnée du problème et complète les éléments manquants ce qui montre qu’il comprend la tâche dans son ensemble. Le candidat utilise son temps et ses compétences pour obtenir de bons résultats dans son travail. Il connaît les bases théoriques des techniques utilisées mais ne les utilise pas toujours de manière adéquate. Son approche des problématiques ne démontre pas toujours une démarche ciblée de l’objectif a atteindre.<br><h3>Niveau de qualité 1</h3>L’élaboration des résultats démontre que le candidat se donne de la peine à réaliser la donnée du problème à satisfaction. Le candidat utilise son temps et ses compétences pour obtenir des résultats de travail suffisants. Il oublie parfois de porter attention au temps qui s’écoule et se satisfait de résultats se trouvant à un stade de réalisation précoce. Les bases théoriques néccessaires sont lacunaires et rendent difficile l’atteinte d’une approche ciblée de la démarche pour atteindre l’objectif.<br><h3>Niveau de qualité 0</h3> Dans l’élaboration des résultats du travail il est difficile de vérifier que le candidat s’est donné de la peine pour accomplir la tâche de manière satisfaisante. Il n’investit du temps et n’utilise ses compétences que sur demande et fournit des résultats limite satisfaisants ou de qualité discutable. Il oublie de porter attention au temps écoulé ou se satisfait de résultats qui nécessitent d’être retravaillés à plusieurs reprises. Les connaissances théoriques sont lacunaires ou absentes. ",
		},
		{
			id: "A8",
			title: "Autonomie de travail",
			help: "Le ou la candidat-e se procure et élabore les informations requises, cherche des variantes de solution et prend des décisions de façon compétente et professionnelle. Il ou elle répartit son travail et détermine ainsi le bon déroulement de son TPI.<br><h3>Niveau de qualité 3</h3>1. Sait distinguer l’essentiel du superflu et établir des priorités<br>2. Il utilise les moyens dont il dispose et arrive à les utiliser de manière autonome pour obtenir les informations nécessaires.<br>3. N’a besoin d’aucun soutien injustifié d’autres professionnels.<h3>Niveau de qualité 2</h3>Deux des points mentionnés sont remplis.<br><h3>Niveau de qualité 1</h3>Un des points est rempli ou les trois sont en partie remplis.<br><h3>Niveau de qualité 0</h3> Aucun des points n’est rempli. Ou le candidat ne demande aucune information ou aide supplémentaire, bien que cela aurait été nécessaire pour la progression et la réussite de son travail. ",
		},
		{
			id: "A9",
			title: "Connaissances professionnelles et application adéquate ",
			help: "L’expert se distingue du néophyte dans la mesure où ses actions sont guidées par l’application cohérente du savoir acquis en fonction d’une situation donnée. Il ne sait pas seulement ce qu’il fait, mais aussi pourquoi et comment procéder correctement. Un travail efficient exige de bien connaître les méthodes et les produits requis et de maîtriser leur utilisation.<br><h3>Niveau de qualité 3</h3>Le candidat a démontré tout au long de son travail, qu’il dispose des connaissances professionnelles de base et des connaissances techniques nécessaires à ses tâches et qu’il les applique de façon cohérente dans chaque situation. Le candidat applique avec assurance les compétences nécessaires à l’utilisation des produits mis en oeuvre pour atteindre l’objectif fixé et le fait de manière routinière et sans aucune erreur.<br><h3>Niveau de qualité 2</h3>Des déclarations incertaines ou imprécises de terminologies ou connaissances professionnelles démontrent des faiblesses. Le candidat n’utilise les connaissances nécessaires aux produits utilisés uniquement au moyen de détours ou de recherches et la mise en oeuvre est parfois fastidieuse et il ne sait pas comment les utiliser.<br><h3>Niveau de qualité 1</h3>Le candidat élude la question ou fait des déclarations erronées. Il répond par des déclarations basées sur des préjugés irréfléchis ou des opinions personnelles qui démontrent de grandes lacunes au niveau des connaissances professionnelles. Le candidat utilise les produits mis en œuvre de manière incomplète, incertaine et superficielle. Il n’utilise parfois pas les bons produits qui ne sont pas adaptés pour l’atteinte de l’objectif.<br><h3>Niveau de qualité 0</h3> Le candidat ne connait pas les bases techniques nécessaires à la réalisation de son travail ou il ne fait pas le lien avec ce qu’il a appris. Le candidat ne connait pas les produits mis en oeuvre, ce qui se ressent par une démarche très incertaine. Il ne trouve pas les fonctionnalités demandées ou uniquement après une longue recherche. Il utilise les produits nécessaires de manière erronée ou ne les utilise pas du tout. ",
		},
		{
			id: "A10",
			title: "Utilisation du jargon / terminologie métier appropriée ",
			help: "Le vocabulaire technique sert à expliquer des situations ou contenus spécifiques. L’utilisation de termes spécialisés est conforme à leur acception et correcte. Le ou la candidat-e est à même d’expliquer de façon compréhensible les termes techniques et acronymes utilisés.<br><h3>Niveau de qualité 3</h3>1. Le candidat utilise systématiquement la terminologie appropriée et usuelle de la profession pour expliquer les situations spécifiques.<br>2. Dans ce cadre, les termes techniques sont utilisés correctement et de manière précise.<br>3. Les termes et acronymes sont utilisés au bon endroit et peuvent être expliqués par le candidat sur demande.<br>4. L’explication des termes techniques est irréprochable.<br><h3>Niveau de qualité 2</h3>Trois des points mentionnés sont remplis.<br><h3>Niveau de qualité 1</h3>Deux des points mentionnés sont remplis ou les quatre sont remplis partiellement.<br><h3>Niveau de qualité 0</h3> Un seul ou aucun des points mentionnés n’est rempli. ",
		},
		{
			id: "A11",
			title: "Procédure de travail et méthode professionnelle ",
			help: "La bonne procédure de travail et une méthode professionnelle appropriée sont appliquées aux différentes tâches à effectuer.<br><h3>Niveau de qualité 3</h3>Choisit des méthodes et techniques appropriées aux tâches concernées. Celles-ci sont mise en œuvre correctement et dans leur intégralité.<br><h3>Niveau de qualité 2</h3>Les méthodes sont appropriées et correctes mais mises en œuvre de manière incomplète.<br><h3>Niveau de qualité 1</h3>Les méthodes sont appropriées mais pas mises en œuvre correctement.<br><h3>Niveau de qualité 0</h3> Pas de choix ou choix inapproprié de méthodes et techniques. ",
		},
		{
			id: "A12",
			title: "Organisation des résultats du travail ",
			help: "Un classement des documents systématique et bien organisé permet d’exploiter au mieux les résultats du travail (documentation, code source, manuels, etc.). Afin de pouvoir accéder en tout temps aux résultats, le ou la candidat-e organise et sauvegarde ses documents. Une organisation correcte se reflétera ensuite dans la documentation.<br><h3>Niveau de qualité 3</h3>1. La gestion des versions des résultats du travail est correcte et reflète bien l’état de développement et permet de retrouver chaque version précédente.<br>2. L’organisation des documents permet de retrouver et de disposer de chaque version différente.<br>3. Les résultats du travail (documentation, code, manuels, etc.) sont enregistrés au moins une fois par jour.<br>4. La restauration des documents enregistrée est assurée.<br>5. L’ergonomie de la place de travail (physique et informatique) a été prise en compte. Elle est mise en place en fonction des besoins tout au long du TPI.<br>6. Les points 1 à 5 sont tous décrits et retraçables dans le rapport du TPI.<br><h3>Niveau de qualité 2</h3>Cinq des points mentionnés sont remplis.<br><h3>Niveau de qualité 1</h3>Quatre des points mentionnés sont remplis.<br><h3>Niveau de qualité 0</h3> Trois points mentionnés ou moins sont remplis. ",
		},
		{
			id: "A13",
			title: "Performance ",
			help: "L’étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>L'efficacité/la performance du candidat ainsi que l’étendue et le dégré de finition/réalisation du produit correspondent au résultat attendu d'un professionnel du métier. Tout le potentiel à retirer de la donnée du problème du TPI ressort clairement et a été réalisé dans le temps imparti par le cahier des charges.<br><h3>Niveau de qualité 2</h3>L’étendue et le degré de finition/réalisation du produit correspondent au résultat d’un professionnel du métier. Le potentiel de la donnée du problème du TPI a été correctement réalisé dans les temps.<br><h3>Niveau de qualité 1</h3>L’étendue et le degré de finition/réalisation du produit correspondent partiellement au résultat attendu d’un professionnel du métier. Le potentiel de la donnée du problème n’a été que partiellement réalisé dans le temps imparti.<br><h3>Niveau de qualité 0</h3> L’étendue et le degré de finition/réalisation du produit ne correspondent en grande partie pas au résultat attendu d’un professionnel. Le potentiel de la donnée du problème n’a pas été mis en oeuvre dans le temps imparti ou que dans certains cas. ",
		},
		{
			id: "A14",
			title:
				"Point techniques évalués spécifiques au projet (Point 8.1 du CdC) ",
			help: "Le candidat a-t-il répondu/fait l'ensemble des points techniques évalués spécifiques au projet de manière correcte et suffisamment professionnelle? L’étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Le candidat a traité de manière professionnelle le point technique. Toutes les parties du point sont fournies correctement et avec compétences professionnelles. Le candidat peut également répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 2</h3>Le candidat a négligé un ou plusieurs aspects du point technique peu important ou un aspect d'importance cruciale n'est pas suffisamment éclairci. Le candidat peut également principalement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Le candidat a négligé un aspect du point technique de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3> Le candidat n'a pas répondu correctement au point technique. ",
		},
		{
			id: "A15",
			title:
				"Point techniques évalués spécifiques au projet (Point 8.2 du CdC) ",
			help: "Le candidat a-t-il répondu/fait l'ensemble des points techniques évalués spécifiques au projet de manière correcte et suffisamment professionnelle? L’étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Le candidat a traité de manière professionnelle le point technique. Toutes les parties du point sont fournies correctement et avec compétences professionnelles. Le candidat peut également répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 2</h3>Le candidat a négligé un ou plusieurs aspects du point technique peu important ou un aspect d'importance cruciale n'est pas suffisamment éclairci. Le candidat peut également principalement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Le candidat a négligé un aspect du point technique de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3> Le candidat n'a pas répondu correctement au point technique. ",
		},
		{
			id: "A16",
			title:
				"Point techniques évalués spécifiques au projet (Point 8.3 du CdC) ",
			help: "Le candidat a-t-il répondu/fait l'ensemble des points techniques évalués spécifiques au projet de manière correcte et suffisamment professionnelle? L’étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Le candidat a traité de manière professionnelle le point technique. Toutes les parties du point sont fournies correctement et avec compétences professionnelles. Le candidat peut également répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 2</h3>Le candidat a négligé un ou plusieurs aspects du point technique peu important ou un aspect d'importance cruciale n'est pas suffisamment éclairci. Le candidat peut également principalement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Le candidat a négligé un aspect du point technique de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3> Le candidat n'a pas répondu correctement au point technique. ",
		},
		{
			id: "A17",
			title:
				"Point techniques évalués spécifiques au projet (Point 8.4 du CdC) ",
			help: "Le candidat a-t-il répondu/fait l'ensemble des points techniques évalués spécifiques au projet de manière correcte et suffisamment professionnelle? L’étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Le candidat a traité de manière professionnelle le point technique. Toutes les parties du point sont fournies correctement et avec compétences professionnelles. Le candidat peut également répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 2</h3>Le candidat a négligé un ou plusieurs aspects du point technique peu important ou un aspect d'importance cruciale n'est pas suffisamment éclairci. Le candidat peut également principalement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Le candidat a négligé un aspect du point technique de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3> Le candidat n'a pas répondu correctement au point technique. ",
		},
		{
			id: "A18",
			title:
				"Point techniques évalués spécifiques au projet (Point 8.5 du CdC) ",
			help: "Le candidat a-t-il répondu/fait l'ensemble des points techniques évalués spécifiques au projet de manière correcte et suffisamment professionnelle? L’étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Le candidat a traité de manière professionnelle le point technique. Toutes les parties du point sont fournies correctement et avec compétences professionnelles. Le candidat peut également répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 2</h3>Le candidat a négligé un ou plusieurs aspects du point technique peu important ou un aspect d'importance cruciale n'est pas suffisamment éclairci. Le candidat peut également principalement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Le candidat a négligé un aspect du point technique de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3> Le candidat n'a pas répondu correctement au point technique. ",
		},
		{
			id: "A19",
			title:
				"Point techniques évalués spécifiques au projet (Point 8.6 du CdC) ",
			help: "Le candidat a-t-il répondu/fait l'ensemble des points techniques évalués spécifiques au projet de manière correcte et suffisamment professionnelle? L’étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Le candidat a traité de manière professionnelle le point technique. Toutes les parties du point sont fournies correctement et avec compétences professionnelles. Le candidat peut également répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 2</h3>Le candidat a négligé un ou plusieurs aspects du point technique peu important ou un aspect d'importance cruciale n'est pas suffisamment éclairci. Le candidat peut également principalement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Le candidat a négligé un aspect du point technique de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3> Le candidat n'a pas répondu correctement au point technique. ",
		},
		{
			id: "A20",
			title:
				"Point techniques évalués spécifiques au projet (Point 8.7 du CdC) ",
			help: "Le candidat a-t-il répondu/fait l'ensemble des points techniques évalués spécifiques au projet de manière correcte et suffisamment professionnelle? L’étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Le candidat a traité de manière professionnelle le point technique. Toutes les parties du point sont fournies correctement et avec compétences professionnelles. Le candidat peut également répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 2</h3>Le candidat a négligé un ou plusieurs aspects du point technique peu important ou un aspect d'importance cruciale n'est pas suffisamment éclairci. Le candidat peut également principalement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Le candidat a négligé un aspect du point technique de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3> Le candidat n'a pas répondu correctement au point technique. ",
		},
		{
			id: "B1",
			title: "Résumé du rapport du TPI / version succincte de la doc.",
			help: "Un résumé conceptuel du travail effectué et du résultat obtenu permet aux lecteurs impliqués dans le projet (supérieur, experts) de mieux comprendre le travail fourni. La version succincte ne contient pas de graphiques, mais uniquement du texte.  <br> <h3>Niveau de qualité 3 </h3>1. Le résumé est destiné à un public professionnel de la branche (langage, style, niveau de détail et termes techniques utilisés)<br>2. Il contient trois paragraphes : Situation de départ, mise en œuvre, résultats.  <br>3. Le résumé contient pour l'ensemble des points précités que des aspects essentiels.<br>4. Il n'est pas plus long qu'une page A4 de texte et ne contient pas de graphiques  <br> <h3>Niveau de qualité 2 </h3>Trois des points sont remplis.  <br> <h3>Niveau de qualité 1</h3>Deux des points sont remplis.  <br> <h3>Niveau de qualité 0</h3>Moins de deux points sont remplis.",
		},
		{
			id: "B2",
			title: "Tenue du journal de travail ",
			help: "Le journal de travail sert à documenter les activités quotidiennes, les problèmes rencontrés ainsi que les éventuels travaux imprévus, aides et heures supplémentaires. Il est clairement structuré et se réfère au plan du projet.  <br> <h3>Niveau de qualité 3 </h3>1. La structure et la présentation sont claires. 2. Toutes les activités planifiées ainsi que les imprévus et les heures supplémentaires y sont mentionnés. 3. Les succès et les échecs sont mentionnés. 4. Le travail journalier et son appréciation critique y figurent.  <br> <h3>Niveau de qualité 2 </h3>Trois des points d'évaluation sont remplis.  <br> <h3>Niveau de qualité 1</h3>Deux points d'évaluation sont remplis.  <br> <h3>Niveau de qualité 0</h3>Moins de deux exigences sont remplies ou l'aide de la part d'une personne tierce n'est pas mentionnée ou de toute évidence les heures supplémentaires effectuées ne sont pas mentionnées. ",
		},
		{
			id: "B3",
			title: "Capacité de réflexion ",
			help: "La réflexion est la capacité de la personne en formation d'analyser la manière dont elle a exécuté la tâche dans son ensemble et d'identifier les points où elle pourrait s'améliorer. Ces constats sont documentés dans le journal de travail et dans la conclusion.  <br> <h3>Niveau de qualité 3 </h3>1. Le rapport contient une réflexion critique du candidat sur l'approche qu'il a suivie et les résultats obtenus.<br>2. Compare les variantes de solutions possibles ou justifie pourquoi il n'y a pas de variantes.  <br>3. Tire ses propres conclusions qui reflètent sa réflexion.<br>4. Le mot de la fin/la conclusion comprend un bilan personnel.  <br> <h3>Niveau de qualité 2 </h3>Trois des points cités sont remplis.  <br> <h3>Niveau de qualité 1</h3>Deux des points cités sont remplis ou les quatre points sont partiellement remplis.  <br> <h3>Niveau de qualité 0</h3>Un ou aucun des points mentionnés n'est rempli. ",
		},
		{
			id: "B4",
			title: "Structure ",
			help: "Une documentation est compréhensible lorsqu'elle est conçue de manière claire pour un spécialiste extérieur. Les diverses étapes suivent un fil rouge et présentent une structure cohérente.  <br> <h3>Niveau de qualité 3 </h3>1. La documentation est divisée en chapitres en rapport avec les thèmes et les points principaux du projet.<br>2. La documentation est clairement structurée et les titres utilisés contiennent un contenu approprié.  <br>3. L'ordre des thèmes traités dans la documentation est bien coordonné.<br>4. La conception des titres, textes et graphiques simplifie la lecture du rapport et ne l'entrave en aucun cas.  <br> <h3>Niveau de qualité 2 </h3>Trois des points cités sont remplis.  <br> <h3>Niveau de qualité 1</h3>Deux des points cités sont remplis ou les quatre points sont partiellement remplis.  <br> <h3>Niveau de qualité 0</h3>Un ou aucun des points cités n'est rempli.",
		},
		{
			id: "B5",
			title: "Pertinence ",
			help: "L'auteur de la documentation va à l'essentiel en fournissant toutes les informations pertinentes sans entrer dans des détails superflus.  <br> <h3>Niveau de qualité 3 </h3>Le texte du rapport du TPI est conçu de façon optimale et les informations sont concises et les plus pertinentes possibles. Il comprend une suite logique et ne contient pas plus de détails que nécessaire à une exception près si cela est nécessaire à la compréhension d'un thème. Il ne contient pas d'informations superflues de \"\"remplissage\"\".  <br> <h3>Niveau de qualité 2 </h3>Le texte du rapport contient au maximum pour deux points (sous-chapitres) les faiblesses suivantes : Texte trop long (remplissage) / Texte redondant / texte non pertinent / des informations importantes manquent / des informations nécessaires à comprendre des explications sont manquantes.  <br> <h3>Niveau de qualité 1</h3>Le texte du rapport contient les faiblesses suivantes pour trois points au maximum : Texte trop long (remplissage) / Texte redondant / texte non pertinent / des informations importantes manquent / des informations nécessaires à comprendre des explications sont manquantes.  <br> <h3>Niveau de qualité 0</h3>Le texte du rapport contient au maximum pour plus de trois points (sous- chapitres) les faiblesses suivantes : Texte trop long (remplissage) / Texte redondant / texte non pertinent / des informations importantes manquent / des informations nécessaires à comprendre des explications sont manquantes. ",
		},
		{
			id: "B6",
			title: "Respect des prescriptions formelles du rapport du TPI ",
			help: "Il s'agit ici d'évaluer le caractère exhaustif de la documentation du point de vue formel, conformément aux prescriptions de l'expert en chef cantonal.  <br> <h3>Niveau de qualité 3 </h3>1. La mise en page et le contenu du PDF et du fichier Word/de la version imprimée sont identiques<br>2. Le rapport est séparé en deux parties distinctes. Le code source est annexé.  <br>3. Le rapport contient : L'organisation du projet, le journal, le planning.  <br>4. Le rapport du TPI contient une table des matières à jour (num. page etc.).<br>5. Le rapport contient une liste des sources et références complète et structurée.  <br>6. Le rapport du TPI contient un entête et un pied de page sur toutes les pages comprenant la date d'impression et le nom du candidat.<br>7. Le rapport du TPI contient un glossaire trié alphabétiquement comprenant les termes spécifiques au TPI.  <br> <h3>Niveau de qualité 2 </h3>Le point 1 et 5 autres points sont entièrement remplis.  <br> <h3>Niveau de qualité 1</h3>Le point 1 et au moins 3 autres sont remplis.  <br> <h3>Niveau de qualité 0</h3>Le niveau de qualité 1 n'est pas atteint ou moins de cinq points sont atteints.",
		},
		{
			id: "B7",
			title: "Expression écrite et style / orthographe et grammaire",
			help: "L'expression écrite est un vecteur essentiel de transmission et de compréhension des informations et des résultats. Lorsqu'ils sont utilisés à bon escient, de manière correcte et en adéquation avec les destinataires (p. ex. département informatique, spécialistes, tierces personnes), les termes techniques constituent une aide précieuse à la communication pour les informaticiens. L'orthographe influe fortement sur la lisibilité et la compréhensibilité du texte. Un travail soigneux et l'utilisation appropriée des dictionnaires et des outils de correction grammaticale permettent d'éviter les fautes d'orthographe.  <br> <h3>Niveau de qualité 3 </h3>	1.	Le langage utilisé est clair et compréhensible (structure des phrases, ordre des mots utilisés) dans l'entier du rapport du TPI, écrit dans un style fluide avec des phrases complètes et parfaitement formulées.   <br>	2.	Les termes techniques sont utilisés correctement et dans le registre approprié.   <br>	3.	Le rapport du TPI contient peu d'erreur d'orthographe ou de grammaire.   <br>	4.	Les correcteurs électroniques d'orthographe et de grammaire ont été utilisés.   <h3>Niveau de qualité 2 </h3>Trois des points mentionnés sont remplis.  <br> <h3>Niveau de qualité 1</h3>Deux des points mentionnés sont remplis ou trois sont partiellement remplis.  <br> <h3>Niveau de qualité 0</h3>Uniquement un point est rempli ou tous les points sont remplis partiellement. ",
		},
		{
			id: "B8",
			title: "Présentation ",
			help: "La documentation est la carte de visite du travail pratique. Sa présentation témoigne de la cohérence et de l'adéquation du travail du ou de la candidat-e.  <br> <h3>Niveau de qualité 3 </h3>	1.	La présentation contient une numérotation des pages appropriée.   <br>	2.	Le saut de page est utilisé de manière appropriée ou n'entrave pas le  flux de la lecture du rapport.   <br>	3.	Chaque page contient des informations et pas seulement une ligne de  texte ou de titre.   <br>	4.	La présentation est appropriée et propre.   <h3>Niveau de qualité 2 </h3>Trois points sont remplis.  <h3>Niveau de qualité 1</h3>Deux points sont remplis.  <h3>Niveau de qualité 0</h3>Moins de deux points sont remplis. ",
		},
		{
			id: "B9",
			title: "Graphiques, images, diagrammes et tableaux ",
			help: "Les graphiques, images, diagrammes et tableaux servent à présenter une matière complexe, à la rendre compréhensible ou à la structurer.  <br> <h3>Niveau de qualité 3 </h3>	1.	Des graphiques, images, diagrammes ou des tableaux sont utilisés aux endroits adéquats et permettent de mieux se représenter le contenu du rapport du TPI et rendre le texte plus compréhensible.   <br>	2.	Le choix du schéma/de la représentation est approprié dans l'entier du TPI.   <br>	3.	Les images sont visuellement lisibles   <br>	4.	Les images sont compréhensibles au niveau du contenu.   <br>	5.	Les illustrations sont pertinentes et représentatives.   <br>	6.	Les illustrations sont expliquées dans une légende ou un texte.   <br>	7.	Les illustrations sont appropriées au contexte.   <h3>Niveau de qualité 2 </h3>6 aspects sont bien remplis.  <h3>Niveau de qualité 1</h3>4 aspects sont bien remplis.  <h3>Niveau de qualité 0</h3>Moins de 4 aspects sont bien remplis.",
		},
		{
			id: "B10",
			title: "Documentation de la procédure de tests et de ses résultats ",
			help: "Les résultats des tests sont compréhensibles et reproductibles lorsque l'installation de test, les méthodes et les outils utilisés à cet effet sont décrits de telle manière que des spécialistes externes puissent exécuter eux-mêmes la procédure. Tous les tests, prévus ou imprévus, sont documentés.  <br> <h3>Niveau de qualité 3 </h3>	1.	Le protocole de tests est basé sur l'équipement de test, les scénarios de tests et les moyens d'aide à disposition.   <br>	2.	Il est facilement compréhensible.   <br>	3.	Les actions et les paramètres sont décrits sans aucune ambiguité.   <br>	4.	Tous les résultats des tests sont documentés.   <h3>Niveau de qualité 2 </h3>Trois des aspects sont bien remplis.  <br> <h3>Niveau de qualité 1</h3>Deux des aspects sont bien remplis.  <br> <h3>Niveau de qualité 0</h3>Moins de deux aspects sont bien remplis.",
		},
		{
			id: "C1",
			title: "Gestion du temps, structure ",
			help: "La structure et le contenu de la présentation se limitent aux principaux aspects (tâches, déroulement, résultats) du TPI. Le temps imparti pour la présentation doit être respecté.<h3>Niveau de qualité 3</h3>1. La présentation comporte une introduction avec un bref aperçu qui fait le lien avec la suite de la présentation et contient donc une partie centrale ainsi qu'une conclusion comprenant une évaluation critique du travail effectué.<br>2. La présentation fait ressortir les aspects essentiels du résultat du TPI.<br>3. La présentation se concentre sur les aspects pertinents.<br>4. La présentation est faite dans un ordre logique et construite de<br>manière cohérente.<br>5. Le temps de présentation est strictement respecté.<br><h3>Niveau de qualité 2</h3>Trois points des points 1 à 4 sont remplis ou le temps de présentation n'a pas été dépassé de plus de 2 minutes.<br><h3>Niveau de qualité 1</h3>Deux points des points 1 à 4 sont respectés ou le temps de présentation n'a pas été dépassé ou été inférieur de plus de 4 minutes.<br><h3>Niveau de qualité 0</h3>Un seul point des points 1 à 4 est rempli ou le temps de présentation a été dépassé ou été inférieur de plus de 4 minutes.",
		},
		{
			id: "C2",
			title: "Présentation : Utilisation de médias, aspects techniques ",
			help: "Pour la présentation du projet, des outils techniques<br>sont utilisés seuls ou en combinaison. Le ou la candidat-e doit savoir les utiliser correctement et à bon escient.<h3>Niveau de qualité 3</h3>1. Utilise les moyens techniques appropriés pour appuyer la présentation<br>2. Utilise correctement les moyens techniques à disposition.<br>3. Le langage et les médias utilisés sont idéalement choisis et se<br>complètent parfaitement.<br><h3>Niveau de qualité 2</h3>Deux des points mentionnés sont remplis ou deux points sont partiellement remplis.<br><h3>Niveau de qualité 1</h3>Un des points mentionnés est rempli ou trois points sont partiellement remplis.<br><h3>Niveau de qualité 0</h3>Aucun des points mentionnés n'est rempli.",
		},
		{
			id: "C3",
			title: "Technique de présentation ",
			help: "La présentation se fait dans la langue employée à l'école. Le ou la candidat-e doit formuler des phrases correctes et intelligibles. Les formulations et le langage technique sont en adéquation avec le public cible (spécialistes, experts). Le volume de la voix, la vitesse d'élocution ainsi que la gestuelle sont adaptés au public cible et aux locaux.<br><h3>Niveau de qualité 3</h3>1. Les déclarations sont parfaitement formulées.<br>2. Les phrases sont formulées de manière claire, complète et<br>linguistiquement correcte.<br>3. La discussion est claire.<br>4. La gestuelle/les mimiques sont adaptées au public cible.<br>5. Un contact visuel fréquent est visible et ce avec tous les auditeurs.<br><h3>Niveau de qualité 2</h3>Quatre points sont remplis. <br><h3>Niveau de qualité 1</h3>Trois points sont remplis.<br><h3>Niveau de qualité 0</h3>Deux points ou moins de deux points sont remplis.",
		},
		{
			id: "C4",
			title: "Echange d'information avec les experts durant le TPI ",
			help: "L'échange d'informations entre le candidat et les experts s'est fait correctement durant toute la procédure du TPI<br><h3>Niveau de qualité 3</h3>Le candidat a toujours répondu durant le TPI dans un délai acceptable aux questions et demandes des experts.<br>Le candidat a envoyé à chaque échéance les documents<br>demandés<br><h3>Niveau de qualité 2</h3>Le candidat n'a pas répondu dans un délai acceptable, ou n'a pas envoyé un document dans les délais entre une et deux fois.<br><h3>Niveau de qualité 1</h3>Le candidat n'a pas répondu dans un délai acceptable, ou n'a pas envoyé un document dans les délais entre trois et quatre fois.<br><h3>Niveau de qualité 0</h3>Le candidat n'a pas répondu dans un délai acceptable, ou n'a pas envoyé un document dans les délais plus de quatre fois.",
		},
		{
			id: "C5",
			title: "Question des experts 1",
			help: "Le candidat est-il apte à répondre à la question/l'ensemble des experts<br>concernant son travail de manière correcte et suffisamment professionnelle?<br>L'étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Les réponses aux questions traitent de tous les aspects de façon professionnelle et différenciée. Les déclarations faites sont, lorsque nécessaire, étayées par des exemples ou assorties de conclusions logiques. Les réponses sont correctes et reflètent les compétences techniques. Le ou la candidat-e peut aussi fournir des renseignements précis sur des détails. Il ou elle répond avec exactitude aux questions des experts, pose des questions si nécessaire et adopte un comportement correct<br><h3>Niveau de qualité 2</h3>Les réponses aux questions négligent un ou plusieurs aspects peu importants ou un aspect d'importance cruciale n'est pas suffisamment éclairci. La plupart des déclarations sont illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit principalement des réponses correctes et peut généralement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Les réponses aux questions négligent un aspect de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Un grand nombre de déclarations ne sont pas illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3>Le candidat ne peut pas répondre correctement à la question/à l'ensemble de questions concernant son travail d'examen.",
		},
		{
			id: "C6",
			title: "Question des experts 2",
			help: "Le candidat est-il apte à répondre à la question/l'ensemble des experts<br>concernant son travail de manière correcte et suffisamment professionnelle?<br>L'étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Les réponses aux questions traitent de tous les aspects de façon professionnelle et différenciée. Les déclarations faites sont, lorsque nécessaire, étayées par des exemples ou assorties de conclusions logiques. Les réponses sont correctes et reflètent les compétences techniques. Le ou la candidat-e peut aussi fournir des renseignements précis sur des détails. Il ou elle répond avec exactitude aux questions des experts, pose des questions si nécessaire et adopte un comportement correct<br><h3>Niveau de qualité 2</h3>Les réponses aux questions négligent un ou plusieurs aspects peu importants ou un aspect d'importance cruciale n'est pas suffisamment éclairci. La plupart des déclarations sont illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit principalement des réponses correctes et peut généralement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Les réponses aux questions négligent un aspect de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Un grand nombre de déclarations ne sont pas illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3>Le candidat ne peut pas répondre correctement à la question/à l'ensemble de questions concernant son travail d'examen.",
		},
		{
			id: "C7",
			title: "Question des experts 3",
			help: "Le candidat est-il apte à répondre à la question/l'ensemble des experts<br>concernant son travail de manière correcte et suffisamment professionnelle?<br>L'étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Les réponses aux questions traitent de tous les aspects de façon professionnelle et différenciée. Les déclarations faites sont, lorsque nécessaire, étayées par des exemples ou assorties de conclusions logiques. Les réponses sont correctes et reflètent les compétences techniques. Le ou la candidat-e peut aussi fournir des renseignements précis sur des détails. Il ou elle répond avec exactitude aux questions des experts, pose des questions si nécessaire et adopte un comportement correct<br><h3>Niveau de qualité 2</h3>Les réponses aux questions négligent un ou plusieurs aspects peu importants ou un aspect d'importance cruciale n'est pas suffisamment éclairci. La plupart des déclarations sont illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit principalement des réponses correctes et peut généralement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Les réponses aux questions négligent un aspect de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Un grand nombre de déclarations ne sont pas illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3>Le candidat ne peut pas répondre correctement à la question/à l'ensemble de questions concernant son travail d'examen.",
		},
		{
			id: "C8",
			title: "Question des experts 4",
			help: "Le candidat est-il apte à répondre à la question/l'ensemble des experts<br>concernant son travail de manière correcte et suffisamment professionnelle?<br>L'étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Les réponses aux questions traitent de tous les aspects de façon professionnelle et différenciée. Les déclarations faites sont, lorsque nécessaire, étayées par des exemples ou assorties de conclusions logiques. Les réponses sont correctes et reflètent les compétences techniques. Le ou la candidat-e peut aussi fournir des renseignements précis sur des détails. Il ou elle répond avec exactitude aux questions des experts, pose des questions si nécessaire et adopte un comportement correct<br><h3>Niveau de qualité 2</h3>Les réponses aux questions négligent un ou plusieurs aspects peu importants ou un aspect d'importance cruciale n'est pas suffisamment éclairci. La plupart des déclarations sont illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit principalement des réponses correctes et peut généralement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Les réponses aux questions négligent un aspect de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Un grand nombre de déclarations ne sont pas illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3>Le candidat ne peut pas répondre correctement à la question/à l'ensemble de questions concernant son travail d'examen.",
		},
		{
			id: "C9",
			title: "Question des experts 5",
			help: "Le candidat est-il apte à répondre à la question/l'ensemble des experts<br>concernant son travail de manière correcte et suffisamment professionnelle?<br>L'étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Les réponses aux questions traitent de tous les aspects de façon professionnelle et différenciée. Les déclarations faites sont, lorsque nécessaire, étayées par des exemples ou assorties de conclusions logiques. Les réponses sont correctes et reflètent les compétences techniques. Le ou la candidat-e peut aussi fournir des renseignements précis sur des détails. Il ou elle répond avec exactitude aux questions des experts, pose des questions si nécessaire et adopte un comportement correct<br><h3>Niveau de qualité 2</h3>Les réponses aux questions négligent un ou plusieurs aspects peu importants ou un aspect d'importance cruciale n'est pas suffisamment éclairci. La plupart des déclarations sont illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit principalement des réponses correctes et peut généralement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Les réponses aux questions négligent un aspect de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Un grand nombre de déclarations ne sont pas illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3>Le candidat ne peut pas répondre correctement à la question/à l'ensemble de questions concernant son travail d'examen.",
		},
		{
			id: "C10",
			title: "Question des experts 6",
			help: "Le candidat est-il apte à répondre à la question/l'ensemble des experts<br>concernant son travail de manière correcte et suffisamment professionnelle?<br>L'étendue et le degré de finition du produit correspondent au temps investi.<br><h3>Niveau de qualité 3</h3>Les réponses aux questions traitent de tous les aspects de façon professionnelle et différenciée. Les déclarations faites sont, lorsque nécessaire, étayées par des exemples ou assorties de conclusions logiques. Les réponses sont correctes et reflètent les compétences techniques. Le ou la candidat-e peut aussi fournir des renseignements précis sur des détails. Il ou elle répond avec exactitude aux questions des experts, pose des questions si nécessaire et adopte un comportement correct<br><h3>Niveau de qualité 2</h3>Les réponses aux questions négligent un ou plusieurs aspects peu importants ou un aspect d'importance cruciale n'est pas suffisamment éclairci. La plupart des déclarations sont illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit principalement des réponses correctes et peut généralement répondre à des questions détaillées par des renseignements précis.<br><h3>Niveau de qualité 1</h3>Les réponses aux questions négligent un aspect de grande importance ou des aspects d'importance cruciale ne sont pas suffisamment éclaircis. Un grand nombre de déclarations ne sont pas illustrées par des exemples ou des conclusions logiques lorsque cela est nécessaire. Le candidat fournit souvent des réponses erronées ou imprécises.<br><h3>Niveau de qualité 0</h3>Le candidat ne peut pas répondre correctement à la question/à l'ensemble de questions concernant son travail d'examen.",
		},
	];
	let tabindex = 20; // Leave some room for header fields

	// Build the tables
	for (item of criteria) {
		let r = document.createElement("div");
		r.className = "row";

		// id cell
		let cid = document.createElement("div");
		cid.className = "cell col-1";
		cid.innerText = item.id;
		cid.id = item.id;
		cid.addEventListener("click", function (e) {
			showModal(e.target.id);
		});

		// name cell
		let cname = document.createElement("div");
		cname.className = "cell col-7";
		cname.innerText = item.title;

		// Add text input for specific criteria
		if (
			item.id.charAt(0) == "A" &&
			parseInt(item.id.substring(1)) >= 14 &&
			parseInt(item.id.substring(1)) <= 20
		) {
			let desccrit = document.createElement("input");
			desccrit.type = "text";
			desccrit.id = "critspec" + item.id;
			desccrit.tabIndex = tabindex++;
			cname.appendChild(desccrit);
		}

		// Add text input for the question
		if (
			item.id.charAt(0) == "C" &&
			parseInt(item.id.substring(1)) >= 5 &&
			parseInt(item.id.substring(1)) <= 10
		) {
			let question = document.createElement("input");
			question.type = "text";
			question.id = "question" + item.id;
			question.tabIndex = tabindex++;
			cname.appendChild(question);
		}

		let cpts = document.createElement("div");
		cpts.className = "cell col-1 center";
		let numcpts = document.createElement("input");
		numcpts.className = "points";
		numcpts.type = "number";
		numcpts.min = 0;
		numcpts.max = 3;
		numcpts.id = "pts" + item.id;
		numcpts.tabIndex = tabindex++;
		cpts.appendChild(numcpts);

		// justification cell
		let cjust = document.createElement("div");
		cjust.className = "cell col-7 center";
		let txtjust = document.createElement("textarea");
		txtjust.id = "just" + item.id;
		txtjust.type = "text";
		txtjust.tabIndex = tabindex++;
		cjust.appendChild(txtjust);

		// finalize row
		r.appendChild(cid);
		r.appendChild(cname);
		r.appendChild(cpts);
		r.appendChild(cjust);

		// add row to the appropriate table
		switch (item.id.charAt(0)) {
			case "A":
				tblProComp.appendChild(r);
				break;
			case "B":
				tblDoc.appendChild(r);
				break;
			case "C":
				tblPres.appendChild(r);
				break;
			default:
				break;
		}
	}

	// Définit les gestionnaires d'événements pour maintenir la précision de la note
	var inputsPoints = document.getElementsByClassName("points");

	for (var i = 0; i < inputsPoints.length; i++) {
		inputsPoints[i].addEventListener("change", function (e) {
			var value = parseInt(e.target.value);
			value = Math.max(0, Math.min(3, value)); // Limite la valeur entre 0 et 3
			e.target.value = value;
			computeGrade();
		});
	}

	// Compute and display the grades, doing sub totals per part
	function computeGrade() {
		let totalA = 0;
		let totalB = 0;
		let totalC = 0;

		// Calculer les totaux pour chaque partie en parcourant les éléments de classe "points"
		for (let inputPoints of document.getElementsByClassName("points")) {
			const value = parseInt(inputPoints.value);
			const part = inputPoints.parentNode.parentNode.parentNode.dataset.part;

			switch (part) {
				case "A":
					totalA += value;
					break;
				case "B":
					totalB += value;
					break;
				case "C":
					totalC += value;
					break;
			}
		}

		// Mettre à jour les éléments HTML avec les totaux et la note globale
		divTotalA.innerText = totalA;
		divTotalB.innerText = totalB;
		divTotalC.innerText = totalC;

		const total = totalA + totalB + totalC;
		divTotal.innerText = total;

		const grade = (total / 120) * 5 + 1;
		divGrade.innerText = grade.toFixed(1);
	}

	// propagate the candidate name in the sheet and workspace
	function contextualize() {
		spnCandidate.innerText = txtCandidate.value;
		document.title = txtCandidate.value;
	}

	txtCandidate.addEventListener("change", function () {
		contextualize();
	});

	cmdEmpty.addEventListener("click", function () {
		isNewEval = true;
		showFrom();
	});

	function showFrom() {
		divSelector.className = "d-none";
		divPage.classList.remove("d-none");
	}

	document.getElementById("cmdFreeze").addEventListener("click", function handleClick() {
		// Hide the button to indicate it's frozen
		hideButton();
		// Save data and get the filename
		saveData(true, false);
		// Freeze the sheet
		freezeSheet();
	});


	// Function to hide the button
	function hideButton() {
		const cmdFreeze = document.getElementById("cmdFreeze");
		cmdFreeze.style.display = "none";
	}

	function freezeSheet() {
		freezeInputs(document.getElementsByTagName("input"));
		freezeInputs(document.getElementsByTagName("textarea"));
		cmdFreeze.style.display = "none";
		cmdSave.style.display = "none";
	}

	function freezeInputs(inputs) {
		// Work backwards on the list because we are going to destroy the elements
		for (i = inputs.length - 1; i >= 0; i--) {
			let input = inputs[i];
			let parent = input.parentNode;
			let val = document.createElement("div");
			val.className = "value";
			if (input.type == "number") val.classList.add("center");
			val.innerText = input.value;
			parent.removeChild(input);
			parent.appendChild(val);
		}
	}

	// Dispatche les données dans les champs
	function load(data) {
		isNewEval = false; // Permet d'éviter de générer une nouvelle ID

		// Chargement des données de la cartouche
		txtBoss.value = data.cartouche.boss.name;
		txtBossPhone.value = data.cartouche.boss.phone;
		txtBossMail.value = data.cartouche.boss.mail;

		txtCandidate.value = data.cartouche.candidate.name;
		txtCandidatePhone.value = data.cartouche.candidate.phone;
		txtCandidateMail.value = data.cartouche.candidate.mail;

		txtExpert1.value = data.cartouche.expert1.name;
		txtExpert1Phone.value = data.cartouche.expert1.phone;
		txtExpert1Mail.value = data.cartouche.expert1.mail;

		txtExpert2.value = data.cartouche.expert2.name;
		txtExpert2Phone.value = data.cartouche.expert2.phone;
		txtExpert2Mail.value = data.cartouche.expert2.mail;

		// Chargement des critères
		for (crit of data.criteria) {
			document.getElementById("pts" + crit.id).value = crit.points;
			document.getElementById("just" + crit.id).value = crit.justification;
		}

		computeGrade();

		// Chargement des spécificités
		for (i = 14; i <= 20; i++) {
			document.getElementById("critspecA" + i).value = data.specifics[i - 14];
		}

		// Chargement des questions
		for (i = 5; i <= 10; i++) {
			document.getElementById("questionC" + i).value = data.questions[i - 5];
		}

		txtRemarks.value = data.remarks;
		contextualize();

		if (data.frozen) freezeSheet();
	}

	cmdGetFile.addEventListener("click", function () { saveData(false, false); });

	cmdSave.addEventListener("click", function () { saveData(false, true); });

	function generateUniqueId() {

		let timestamp = Date.now().toString();
		// Prendre les 4 derniers chiffres du timestamp
		timestamp = timestamp.substring(timestamp.length - 4);

		let randomNum = Math.random().toString();
		// Prendre les 4 derniers chiffres du nombre aléatoire
		randomNum = randomNum.substring(randomNum.length - 4);

		// Incrémenter le compteur
		counter++;
		let counterStr = counter.toString();

		// Concaténer et retourner le résultat
		return parent(timestamp + randomNum + counterStr);
	}

	function resetIndexedDB(dbName, storeName) {
		let request = indexedDB.open(dbName);

		request.onupgradeneeded = function (event) {
			// Créer l'object store lors de la mise à niveau de la base de données
			let db = event.target.result;
			if (db.objectStoreNames.contains(storeName)) {
				db.deleteObjectStore(storeName);
			}
		};

		request.onsuccess = function (event) {
			let db = event.target.result;

			// Fermer la base de données si elle est ouverte
			if (db) { db.close(); }

			// Supprimer la base de données
			indexedDB.deleteDatabase(dbName);
			debugLog("Suppression de la base de données ", dbName);
		};

		request.onerror = function (event) {
			console.error("Erreur lors de la réinitialisation de la base de données:", event.target.error);
		};

		request.onblocked = function () {
			console.warn("La réinitialisation de la base de données a été bloquée par une autre transaction.");
		};
		location.reload();
	}

	function buildData(final) {
		let id;

		const criteriaData = criteria.map((crit) => ({
			id: crit.id,
			points: document.getElementById(`pts${crit.id}`).value,
			justification: document.getElementById(`just${crit.id}`).value,
		}));

		const specificsData = Array.from(
			{ length: 7 },
			(_, i) => document.getElementById(`critspecA${i + 14}`).value
		);

		const questionsData = Array.from(
			{ length: 6 },
			(_, i) => document.getElementById(`questionC${i + 5}`).value
		);

		const currentDate = new Date();

		debugLog(`Date actuelle : ${currentDate}`);

		if (isNewEval) { id = generateUniqueId(); }
		else { id = tpiEvalCurrent.id; }

		return {
			id: id,
			dateLastSave: currentDate,
			frozen: final,
			cartouche: {
				boss: {
					name: txtBoss.value,
					phone: txtBossPhone.value,
					mail: txtBossMail.value,
				},
				candidate: {
					name: txtCandidate.value,
					phone: txtCandidatePhone.value,
					mail: txtCandidateMail.value,
				},
				expert1: {
					name: txtExpert1.value,
					phone: txtExpert1Phone.value,
					mail: txtExpert1Mail.value,
				},
				expert2: {
					name: txtExpert2.value,
					phone: txtExpert2Phone.value,
					mail: txtExpert2Mail.value,
				},
			},
			criteria: criteriaData,
			specifics: specificsData,
			questions: questionsData,
			remarks: txtRemarks.value,
		};
	}

	function deleteFromIndexedDB(dbName, storeName, id) {
		let request = indexedDB.open(dbName);

		debugLog(`Delete IndexedDB id: ${id}`);

		request.onsuccess = function (event) {
			let db = event.target.result;

			if (!db.objectStoreNames.contains(storeName)) {
				console.log(`Le magasin d'objets '${storeName}' n'existe pas.`);
				return;
			}

			const transaction = db.transaction(storeName, "readwrite");
			const store = transaction.objectStore(storeName);

			const getRequest = store.openCursor();

			getRequest.onsuccess = function (event) {

				const cursor = event.target.result;

				if (cursor) {

					const key = cursor.key;
					const value = cursor.value;

					if (parseInt(value.id) === id) {
						const deleteRequest = store.delete(key);
						deleteRequest.onsuccess = function (event) {
							console.log("Élément supprimé avec succès de IndexedDB");
						};

						deleteRequest.onerror = function (event) {
							console.log(`Erreur lors de la suppression de l'élément : ${event.target.error}`);
						};
					}

					cursor.continue();

				} else {
					console.log(`Aucun élément trouvé avec la clé ${id}`);
				}
			};

			getRequest.onerror = function (event) {
				console.log(`Erreur lors de la récupération de l'élément : ${event.target.error}`);
			};

			transaction.oncomplete = function () {
				console.log("Transaction terminée");
				reloadPageWithDelay();
			};

			transaction.onerror = function (event) {
				console.log(`Erreur lors de la transaction : ${event.target.error}`);
			};
		};

		request.onerror = function (event) {
			console.log(`Erreur lors de l'ouverture de la base de données : ${event.target.error}`);
		};
	}


	function saveToIndexedDB(dbName, storeName, data) {
		let request = indexedDB.open(dbName);

		debugLog("SaveToIndexedDB");

		request.onupgradeneeded = function (event) {
			let db = event.target.result;

			if (!db.objectStoreNames.contains(storeName)) {
				// Si l'object store n'existe pas, le créer lors de la mise à niveau de la base de données
				db.createObjectStore(storeName, { keyPath: "id", autoIncrement: true });
				debugLog("Création de l'object Store");
			}
		};

		request.onsuccess = function (event) {
			let db = event.target.result;

			if (!db.objectStoreNames.contains(storeName)) {
				// Si l'object store n'existe pas, afficher un message d'erreur
				debugLog(`L'object store '${storeName}' n'existe pas.`);
				return;
			}

			let transaction = db.transaction(storeName, "readwrite");
			let store = transaction.objectStore(storeName);

			let getRequest = store.getAll();

			getRequest.onsuccess = function (event) {
				let existingData = event.target.result;

				if (!existingData || existingData.length === 0) {
					// S'il n'y a aucune donnée existante, ajouter les nouvelles données directement
					debugLog("données ajoutée dans avec ADD");
					store.add(data);
				} else {
					let isDuplicate = false;

					for (let existingItem of existingData) {
						// nous devons tester la date ...
						if (existingItem.id === data.id) {
							debugLog("données doublées, mise à jour ");
							// S'il existe déjà une donnée avec le même ID, mettre à jour les données
							isDuplicate = true;
							store.put(data);
							break;
						}
					}
					// S'il n'y a pas de doublon avec le même ID, ajouter les nouvelles données
					if (!isDuplicate) { store.add(data); }
				}

				transaction.oncomplete = function () {
					debugLog("Données sauvegardées dans IndexedDB avec succès");
				};

				transaction.onerror = function (event) {
					debugLog(`Erreur lors de la sauvegarde des données : ${event.target.error}`);
				};
			};

			getRequest.onerror = function (event) {
				debugLog(`Erreur lors de la récupération des données : ${event.target.error}`);
			};
		};

		request.onerror = function (event) {
			debugLog(`Erreur lors de l'ouverture de la base de données : ${event.target.error}`);
		};
	}

	function getFromIndexedDB(dbName, storeName, callback) {
		let request = indexedDB.open(dbName);

		request.onupgradeneeded = function (event) {
			console.log("La base de données n'existe pas.");
			indexedDB.deleteDatabase(dbName);
			callback(false);
		};

		request.onsuccess = function (event) {
			let db = event.target.result;

			if (!db.objectStoreNames.contains(storeName)) {
				console.log(`L'object store '${storeName}' n'existe pas.`);
				callback(false);
				return;
			}

			let transaction = db.transaction(storeName, "readonly");
			let store = transaction.objectStore(storeName);
			let getRequest = store.getAll();

			getRequest.onsuccess = function (event) {
				const data = event.target.result;
				console.log("Données récupérées de IndexedDB :", data);
				callback(data);
			};

			getRequest.onerror = function (event) {
				console.log("Erreur lors de la récupération des données :", event.target.error);
				callback(false);
			};
		};

		request.onerror = function (event) {
			console.log("Erreur lors de l'ouverture de la base de données :", event.target.error);
			callback(false);
		};
	}

	document.getElementById("exportEvalsListToJSON").addEventListener("click", function () { exportDB(db_Evals); });

	async function exportDB(dbName) {
		let db = await new Promise((resolve, reject) => {
			let open = indexedDB.open(dbName);
			open.onsuccess = () => resolve(open.result);
			open.onerror = () => reject(open.error);
		});

		let exportData = {};

		for (let storeName of db.objectStoreNames) {
			exportData[storeName] = await new Promise((resolve, reject) => {
				let objectStore = db.transaction(storeName).objectStore(storeName);
				let data = [];
				objectStore.openCursor().onsuccess = function (e) {
					let cursor = e.target.result;
					if (cursor) {
						data.push(cursor.value);
						cursor.continue();
					} else {
						resolve(data);
					}
				};
			});
		}

		// Convertir les données en une chaîne JSON
		let exportDataStr = JSON.stringify(exportData);

		// Créer un lien de téléchargement pour les données exportées
		let dataUri = "data:text/json;charset=utf-8," + encodeURIComponent(exportDataStr);
		let exportFileDefaultName = "data.json";

		let linkElement = document.createElement("a");
		linkElement.setAttribute("href", dataUri);
		linkElement.setAttribute("download", exportFileDefaultName);
		linkElement.click();
	}

	document.getElementById("importEvalsListToDB").addEventListener("click", function () {
		document.getElementById("fileInput").click();
	});

	document.getElementById("fileInput").addEventListener("change", function (event) {
		const file = event.target.files[0];

		if (file && file.type === "application/json") {
			const fileReader = new FileReader();
			fileReader.onload = function (e) {
				const jsonData = JSON.parse(e.target.result);

				// Utilisez les données JSON importées comme vous le souhaitez
				importDB(db_Evals, jsonData);
			};
			fileReader.readAsText(file);
		} else {
			console.log("Veuillez sélectionner un fichier JSON.");
		}
	});

		function importDB(dbName, importData) {
		// Ouvrir (ou créer) la base de données
		let request = indexedDB.open(dbName);

		request.onupgradeneeded = function (e) {
			// Créer les objects stores si nécessaire
			let db = e.target.result;
			for (let storeName in importData) {
				if (!db.objectStoreNames.contains(storeName)) {
					db.createObjectStore(storeName, { autoIncrement: true });
				}
			}
		};

		request.onsuccess = function (e) {
			// Ouvrir une transaction et importer les données
			let db = e.target.result;
			let transaction = db.transaction(db.objectStoreNames, "readwrite");

			for (let storeName in importData) {
				let store = transaction.objectStore(storeName);
				importData[storeName].forEach((item) => {
					let getRequest = store.get(item.id);

					getRequest.onsuccess = function (event) {
						let existingData = event.target.result;

						if (!existingData) {
							// Aucune donnée existante, ajouter les nouvelles données
							store.add(item);
						} else {
							// Vérifier si la date importée est plus récente
							if (item.date > existingData.date) {
								// La date importée est plus récente, mettre à jour les données
								store.put(item);
							}
						}
					};
				});
			}

			transaction.oncomplete = function () {
				console.log("Données importées dans IndexedDB avec succès");
			};

			transaction.onerror = function (event) {
				console.log(
					`Erreur lors de l'import des données : ${event.target.error}`
				);
			};
		};

		request.onerror = function (e) {
			console.log(
				`Erreur lors de l'ouverture de la base de données : ${e.target.error}`
			);
		};
	}

	function saveData(final, saveToLocal) {

		// Vérifier si c'est une nouvelle évaluation ou une évaluation existante
		let data = buildData(final);

		// Préfixe par défaut pour les clés des évaluations
		const DEFAULT_KEY_PREFIX = "eval";

		// Déterminer la clé ou le nom de fichier en fonction des conditions
		const keyOrFilename = final
			? // Nom personnalisé pour l'évaluation finale
			`Eval TPI ${txtCandidate.value}`
			: dpdevalsListelector.value >= 0
				? // Clé basée sur la sélection du sélecteur
				`${DEFAULT_KEY_PREFIX}${parseInt(dpdevalsListelector.value) + 1}`
				: // Clé basée sur le nombre d'évaluations existantes
				`${DEFAULT_KEY_PREFIX}${loadedEvaluations.length + 1}`;

		if (saveToLocal) {

			// https://developer.mozilla.org/fr/docs/Web/API/IndexedDB_API
			saveToIndexedDB(db_Evals, t_Name, data);

		} else {
			// Télécharger les données au format JSON // Convertir les données en une chaîne JSON
			var dataStr = "data:text/json;charset=utf-8, loadedEvaluations.push(" + encodeURIComponent(JSON.stringify(data)) + ")";
			var downloadAnchorNode = document.createElement("a");
			downloadAnchorNode.setAttribute("href", dataStr);
			downloadAnchorNode.setAttribute("download", keyOrFilename + ".js");
			document.body.appendChild(downloadAnchorNode);
			downloadAnchorNode.click();
			downloadAnchorNode.remove();
		}
		return keyOrFilename;
	}

	const modal = document.getElementById("popup");
	const modalContent = document.getElementById("divModalContent");
	const closeButton = document.querySelector(".close");

	closeButton.addEventListener("click", closeModal);

	function closeModal() { modal.style.display = "none"; }

	function addButton(text, className, clickHandler) {

		const button = document.createElement("button");

		button.innerHTML = text;
		button.classList.add(className);
		button.type = "button";
		button.addEventListener("click", clickHandler);

		modalContent.appendChild(button);
	}

	function addCheckBox() {
		const checkboxContainer = document.createElement("div");
		checkboxContainer.classList.add("checkbox-container");

		const listOfCheckBox = getDuplicatesAndRecentDates();

		listOfCheckBox.forEach((evaluation) => {
			debugLog(`Création de la checkbox : ${evaluation.id}, ${evaluation.status}`);

			evaluation.isChecked = null;

			const elementCheckBox = document.createElement("div");
			elementCheckBox.classList.add("loadedEvaluations");

			const label = document.createElement("label");
			const status = evaluation.status;
			const candidateName = evaluation.cartouche.candidate.name;
			const evaluationId = evaluation.id;

			const checkbox = document.createElement("input");
			checkbox.type = "checkbox";

			checkbox.addEventListener("change", function () {
				if (status !== 2) {
					evaluation.isChecked = checkbox.checked;
					debugLog(`ajout isChecked : ${evaluation.id}, ${evaluation.isChecked}`);
				} else {
					checkbox.checked = false;
					evaluation.isChecked = checkbox.checked;
				}
			});

			switch (status) {
				case 0:
					label.innerText = candidateName;
					label.style.color = "green";
					checkbox.id = "checkbox-" + evaluationId;
					label.setAttribute("for", "checkbox-" + evaluationId);
					break;
				case 1:
					label.innerText = candidateName;
					label.style.color = "red";
					checkbox.id = "checkbox-" + evaluationId;
					label.setAttribute("for", "checkbox-" + evaluationId);
					break;
				case 2:
					label.innerText = candidateName;
					label.style.color = "blue";
					checkbox.id = "checkbox-" + evaluationId;
					label.setAttribute("for", "checkbox-" + evaluationId);
					checkbox.disabled = true;
					break;
				default:
					label.innerText = candidateName + " (Statut inconnu)";
					label.style.color = "black";
			}

			elementCheckBox.appendChild(checkbox);
			elementCheckBox.appendChild(label);
			checkboxContainer.appendChild(elementCheckBox);
		});

		modalContent.appendChild(checkboxContainer);

		return listOfCheckBox;
	}


	function getDuplicatesAndRecentDates() {
		const duplicatesWithRecentDates = [];

		debugLog(`Tableau des js : ${loadedEvaluations.length}`);
		debugLog(`tableau de la DB :${databaseEvaluations.length}`);

		if (!loadedEvaluations || !databaseEvaluations) { return duplicatesWithRecentDates; }

		for (let i = 0; i < loadedEvaluations.length; i++) {
			const loadedEval = loadedEvaluations[i];
			const databaseEval = databaseEvaluations.find((eval) => eval.id === loadedEval.id);

			debugLog(`Loaded Evaluation ID: ${loadedEval.id} `);
			debugLog(`Database Evaluation ID: ${databaseEval ? databaseEval.id : 'Not found'}`);

			if (!databaseEval) {
				// Évaluation non présente dans la base de données
				loadedEval.status = 0;
			} else if (loadedEval.dateLastSave > databaseEval.dateLastSave) {
				// Évaluation présente dans la base de données mais plus récente
				loadedEval.status = 1;
			} else {
				// Évaluation présente dans la BD mais plus ancienne
				loadedEval.status = 2;
			}
			duplicatesWithRecentDates.push(loadedEval);
		}
		return duplicatesWithRecentDates;
	}

	function clearModalContent() {
		const checkboxContainer = modalContent.querySelector(".checkbox-container");

		if (checkboxContainer) {
			modalContent.removeChild(checkboxContainer);
		}
	}

	function onConfirmDelete(id) {
		return function () {
			deleteFromIndexedDB(db_Evals, t_Name, id);
			closeModal();
		};
	}

	function showModal(content, deleteConfirme = false, id = null) {
		debugLog("appel de showModal");

		const crit = criteria.find((c) => c.id === content);

		modal.style.display = "block";

		if (!crit && !deleteConfirme) {
			showEvaluationsContent(content);
		} else if (deleteConfirme) {
			showDeleteConfirmation(content, id);
		} else {
			showCriteriaHelpContent(crit.help);
		}
	}

	function showDeleteConfirmation(content, id) {
		debugLog(`deleteConfirme : ${id}`);

		const confirmButton = document.createElement("button");
		confirmButton.innerText = "Confirmer";
		confirmButton.classList.add("confirmDelete");
		confirmButton.addEventListener("click", onConfirmDelete(id));

		modalContent.innerHTML = content + "<br>";
		modalContent.appendChild(confirmButton);
	}

	function showEvaluationsContent(content) {
		modalContent.innerHTML = content;

		const dataToSave = addCheckBox();

		addButton("Confirmer", "confirmButton", () => onConfirm(dataToSave));
		modalContent.id = "promptOK";
	}


	function showCriteriaHelpContent(helpText) {
		modalContent.id = "divModalContent";
		modalContent.style.overflowY = "auto";
		modalContent.innerHTML = helpText;
	}

	function onConfirm(dataToSave) {
		debugLog("confirmer");

		if (dataToSave && dataToSave.length > 0) {
			const evaluationsToSave = dataToSave
				.filter(data => data.isChecked)
				.map(({ isChecked, status, ...evaluation }) => evaluation);

			saveEvaluationsToIndexedDB(evaluationsToSave);
			closeModal();
			reloadPageWithDelay();
		}
	}


	// Gestionnaire d'événements pour fermer la fenêtre modale en cliquant à l'extérieur
	window.addEventListener("click", (event) => {
		// Vérifier si l'élément cible du clic est la fenêtre modale
		if (event.target === modal) {
			// Appeler la fonction pour fermer la fenêtre modale
			closeModal();
		}
	});

	function debugLog(msg) { if (DEBUG) { console.log(msg) }; }

</script>

</html>